<!-- saved from url=(0022)http://internet.e-mail -->
<html>

<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<style type="text/css">
<!--
body         { font-family: Verdana, Arial, Helvetica, sans-serif }
p, td, blockquote { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12pt }
h1, h2, h3   { font-family: Verdana, Arial, Helvetica, sans-serif; white-space: nowrap; 
               color: #0066CC }
-->
</style>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<h1><a name="start">VTS 3.3.0 </a><i>Quick Start Guide</i></h1>
<p>Visual Test Shell (VTS) is an application for testing the BACnet
functionality of various devices used in building automation systems.&nbsp;
BACnet is a Data Communication Protocol for Building Automation and Control
Networks developed under the auspices of the American Society of Heating,
Refrigerating and Air-Conditioning Engineers (ASHRAE).&nbsp;&nbsp; For
information on BACnet, see <a href="http://www.bacnet.org">http://www.bacnet.org</a>&nbsp;</p>
<p>VTS 3.0 is the third generation of VTS.&nbsp; It is a complete redesign and
rewrite of VTS and there are still some features missing and perhaps even a bug
or two.&nbsp; VTS 3.0 has been turned into an open source project in the hopes
that the users of this program will assist in making it a robust and full
featured BACnet test tool.&nbsp; The home of the VTS 3.0 open source project
is&nbsp; <a href="http://sourceforge.net/projects/vts/">http://sourceforge.net/projects/vts/</a>
. </p>
<p><h4>Go <a href="#whatsnew">here</a> to find out what is new in this release.</h4></p>
<h2>Platform Requirements</h2>
<p>VTS 3.0 runs on Windows98, Windows NT 4.0 (Service Pack 4), Windows2000, or Windows XP.&nbsp; It may also work on Windows95 systems, but there may be some
compatibility problems with several system DLLs on Windows95.&nbsp; (WindowsME
has not been tested). </p>
<h3>Quick Start Guide Contents</h3>
<blockquote>
  <ol>
    <li><a href="#1">Install WinPcap 3.0 (if required)</a></li>
    <li><a href="#2">Install VTS</a></li>
    <li><a href="#3">Run VTS</a></li>
    <li><a href="#4">Create a database</a></li>
    <li><a href="#5">Create a port</a></li>
    <li><a href="#6">Send a packet</a></li>
    <li><a href="#7">Analyze a packet</a></li>
    <li><a href="#8">Create a name</a></li>
    <li><a href="#9">Send a more complicated packet</a></li>
    <li><a href="#10">Analyze the response</a></li>
  </ol>
    <p><a href="#History">VTS Release History</a></p>
    <p><a href="#Links">VTS Web Links</a></p>
</blockquote>
<h2><a name="1">Step 1</a> : Install WinPcap 3.0 (if required)</h2>
<p>If you are interested in Ethernet traffic (not IP, but the ISO 8802-3 
Ethernet data link specified by BACnet clause 7), you need to install WinPcap - otherwise, you
can skip this step. </p> 
<p><ol>
<li>Run the WinPcap installation program packaged with VTS.  This progarm is named WinPcap_3_0.exe.</li>
<li>Follow the instructions on the screen. The installation applet will automatically detect the operating system and install the correct drivers.</li>
</ol> 
If you later want to remove WinPcap from the system, go to the control-panel, click on "add/remove programs" and then select "WinPcap".<p>
For details on WinPcap, check the <a href="http://winpcap.polito.it">WinPcap 
home page</a>. </p>
<blockquote>
  <p>WinPcap is Copyright (c) 1999 - 2003 NetGroup, Politecnico di Torino 
  (Italy). All rights reserved. </p>
  <p>Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are met:
  </p>
  <ol>
    <li>Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer. </li>
    <li>Redistributions in binary form must reproduce the above copyright 
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution. </li>
    <li>Neither the name of the Politecnico di Torino nor the names of its 
    contributors may be used to endorse or promote products derived from this 
    software without specific prior written permission. </li>
  </ol>
  <p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; 
  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE 
  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER 
  CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, 
  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE 
  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</blockquote>



<p><a href="#2">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="2">Step 2</a> : Install VTS</h2>
<p>VTS requires no installation. You may run it from the same directory where it was originally extracted from
the zip archive.  If you move VTS.EXE to a different directory, you must also move the file PTP.DLL
to the same directory.</p>
<p><a href="#3">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="3">Step 3</a> : Run VTS</h2>
<p>Running VTS is as simple as double clicking on the application (VTS.EXE) or
selecting Run from the Start menu and entering <a href="file:///C:/VTS/VTS">C:\VTS\VTS</a>
(assuming that you moved VTS.EXE to the directory C:\VTS).</p>
<p><a href="#4">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="4">Step 4</a> : Create a database</h2>
<p><b>4.1</b> Select New from the File menu. You will be presented with the
follow dialog box:</p>
<p><center><img src="Images/Image02.gif" width="281" height="139"></center></p>
<p>Select VDB, you will be creating a session database. The session database
contains a description of the ports, names bound to addresses, and packets that
were sent or received on each port. VTS allows more than one session database
open at the same time, so it is possible to configure one database for Ethernet
traffic and one for IP and have them both capturing packets at the same time.</p>
<p>The VTS selection is for creating scripts which is not covered in this quick
start guide.</p>
<p><b>4.2</b> Give the session a file name.</p>
<p><center><img src="Images/Image03.gif" width="426" height="285"></center></p>
<p><b>4.3</b> Identify the split pane view of the session.</p>
<p>You will be presented with a split-pane window with three components:</p>
<p><center><img src="Images/Image04.gif" width="719" height="521"></center></p>
<p>A description of the three panes is found in <a href="#7">Step 7</a>. This
session window works as you would expect, the Windows menu allows you to manage
multiple views of the same database and tile or stack them. A large monitor is
recommended for multiple windows.</p>
<p><a href="#5">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="5">Step 5</a> : Create a port</h2>
<p>A port is a communications endpoint that sends and receives packets. Some
ports are associated with a physical interface such as an Ethernet
communications card, and others such as IP ports are associated with a UDP port.</p>
<p><b>5.1</b> Select Ports from the Edit menu. Click on New and give the port a
name. Click on IP and you will see the following dialog box:</p>
<p><center><img src="Images/Image05.gif" width="399" height="366"></center></p>
<p><b>5.2</b> Click on the Configuration button, you will be presented with a
dialog box for configuring the port. Each port type has its own configuration
options.</p>
<p><center><img src="Images/Image06.gif" width="287" height="171"></center></p>
<p>For BACnet/IP ports, the socket 0xBAC0 (or 47808) is the typical socket
number. Click OK, then click on the Enable check box.</p>
<p><center><img src="Images/Image07.gif" width="399" height="366"></center></p>
<p>When a port is enabled it is available for sending and receiving packets. If
the status indicator is red, there is some problem enabling the port and a
description will appear in the status area.</p>
<p><a href="#6">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="6">Step 6</a> : Send a packet</h2>
<p>The most basic function of VTS is to send and receive packets and decode
them. Click on the Send menu and you will see a menu that looks like this:</p>
<p><center><img src="Images/Image08.gif" width="719" height="521"></center></p>
<p>The BAC0 name that is selected is the port created in Step 5. There is only
one enabled port, so it is selected by default, and below the port is a
hierarchical menu of families of types of packets. The BVLL menu has BACnet/IP
specific packets such as Register-Foreign-Device. The Network menu contains
BACnet networking packets such as Who-Is-Router-To-Network. The other menus are
common groups of application layer messages.</p>
<p><b>6.1</b> Select Register-Foreign-Device from the BVLL menu. You will be
presented with the following dialog box:</p>
<p><center><img src="Images/Image09.gif" width="607" height="397"></center></p>
<p>The central feature of the dialog box is a set of tabbed panels, one tab for
each layer in the packet. The Register-Foreign-Device message has only one
parameter, the Time-To-Live. This is a required parameter, as indicated by the
error message in the text area below the panels.</p>
<p><b>6.2</b> Enter a time-to-live in seconds.</p>
<p>When a parameter in the packet contains valid information, other parameters
in other panels are verified to contain correct content.</p>
<p><center><img src="Images/Image10.gif" width="607" height="397"></center></p>
<p><b>6.3</b> Enter the destination address for the packet by selecting the IP
tab. The destination address may be provided by entering an IP address in the
text area, or selecting a name from the drop down menu.</p>
<p><center><img src="Images/Image11.gif" width="607" height="397"></center></p>
<p>By selecting TD, a predefined name for each port, the BACnet/IP address of
the PC will be entered into the text area.</p>
<p><b>6.4</b> Click on the Send button.</p>
<p>When the packet is well formed, the encoded content will appear in the text
area below the panels. This may be edited before sending to test how a device
responds to malformed packets. In the session window you will see an indication
of a packet that has been transmitted.</p>
<p><b>6.5</b> Close the Send dialog box.</p>
<p>The Send dialog box is designed to be non-modal, so it is not closed
automatically. The packet contents can be modified and sent again.</p>
<p><a href="#7">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="7">Step 7</a> : Analyze a packet</h2>
<p>The session window contains three panes. The <b>summary view</b> on the left
has one line per packet and provides general information such as the packet
number, time it arrived, source and destination addresses, and a brief
description of the packet. The <b>detail view</b> in the upper right contains a
complete decoding of the packet contents. The <b>hex view</b> in the lower right
displays the binary content of the packet.</p>
<p><center><img src="Images/Image13.gif" width="719" height="521"></center></p>
<p><b>7.1</b> Select a row in the detail view.</p>
<p>The three views are synchronized so selecting a detail row will highlight the
hex encoding of that specific portion of the packet.</p>
<p><a href="#8">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="8">Step 8</a> : Create a name</h2>
<p>A <b>name</b> is a shortcut for an address. Names are used in the source and
destination address areas of ports, as well as the SNET and DNET portion of the
BACnet network layer. Select Names from the Edit menu and you will be presented
with the following dialog box:</p>
<p><center><img src="Images/Image14.gif" width="486" height="360"></center></p>
<p>Notice that there is already a name TD (common abbreviation for Test Device)
defined and given the address of the port. If this was an Ethernet port, TD
would be the Ethernet address of the port.</p>
<p><b>8.1</b> Click New, change the name to LB, and click on the Local Broadcast
radio button.</p>
<p><center><img src="Images/Image15.gif" width="486" height="360"></center></p>
<p>This name will now represent a local broadcast address for any port. For an
Ethernet port, this is the address FF:FF:FF:FF:FF:FF, for an IP port it is the
address 255.255.255.255:47808. Click on the OK button to close the dialog box.</p>
<p><a href="#9">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="9">Step 9</a> : Send a more complicated packet</h2>
<p>For the next example, send out a global broadcast Who-Is packet.</p>
<p><b>9.1</b> Select Who-Is from the Remote Device Management submenu. You will
be presented with the following dialog box.</p>
<p><center><img src="Images/Image16.gif" width="607" height="397"></center></p>
<p>The device instance low limit and high limit are optional parameters in the
message. By leaving both fields empty, the request will indicate that all
devices must respond.</p>
<p><b>9.2</b> Select the NPCI tab.</p>
<p><center><img src="Images/Image17.gif" width="607" height="397"></center></p>
<p>A Who-Is request is usually sent out as a global broadcast, so the DNET is
present and has the value 65535.</p>
<p><b>9.3</b> Select the BVLCI tab.</p>
<p><center><img src="Images/Image18.gif" width="607" height="397"></center></p>
<p>Assuming the PC is connected to a BACnet/IP network, this message should be
sent out as an original broadcast message.</p>
<p><b>9.4</b> Select the IP tab.</p>
<p><center><img src="Images/Image19.gif" width="607" height="397"></center></p>
<p>The destination address uses the name LB which has the local broadcast
address for the port filled into the edit box.</p>
<p><b>9.5</b> Click Send, then close the dialog box.</p>
<p><a href="#10">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="10">Step 10</a> : Analyze the response</h2>
<p>Here is a sample captured from a test network. Note that there seems to be a
problem with many devices sending their I-Am responses multiple times, or that
some intermediate network component is repeating the message.</p>
<p><center><img src="Images/Image20.gif" width="777" height="520"></center></p>
<p>&nbsp;</p>
<p><a href="#History">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="History">VTS Release History</a></h1>

     <h2>3.0b2</h2>
     Cleaned up support of EPICS references in Expect statements.

     <h2>3.1.4</h2>
	 Added function key shortcuts.  New support for device objects.  Fixed about box to generate a version string at run time.
Added support for the following objects: averaging, multi-state-value, and trendlog;
and all associated properties, EXCEPT: The Log_Buffer property of the TrendLog object.
These changes enable VTS to handle the presence of the new objects in the EPICS.
They also allow the user to perform Object Access services (in the interacterive mode) on devices containing these objects. Cleaned up IP address issues in scripting. DA and SA parameters may now be IP addresses vs. octet strings.

     <h2>3.1.5</h2>
Script support for device object. Includes changes that were made as a result
                     of the Manchester plug-fest, including significant 
                      improvements in application layer scripting. It also includes 
                      bug fixes in the internal router code, along with buffer 
                      overflow bug fixes. Cleaned up a decoding bug with DNET numbers (being treated as a signed integer and then extended to 32 bits).

     <h2>3.1.6</h2>
	 Added ReadRange support, but only for the Send window - no support in scripts yet.
Fixed a TimeSynch encoding bug.

     <h2>3.1.7</h2>
Added the Send UTCTimeSynch service.  Minor improvements in the Send ReadRange interface.  Added a document to the release that provides instruction on how to use VTS 3 for testing BACnet devices.

     <h2>3.1.8</h2>
       <ul>
	    <li>Session data is now cleared, so it doesn't grow continuously, but is not compressed.</li>
	    <li>The Send windows have been sized up to make room for more buttons and clearer indicators.</li>
	    <li>The IDD_SENDREADPROPMULT, IDD_SENDREADPROPMULTACK and IDD_SENDWRITEPROPMULT dialog boxes now have shuffle-up and shuffle-down buttons.  (May still need some work.)</li>
	    <li>All of the Send dialog boxes that have lists now have 'Show selection always' turned on, which doesn't always seem to do what it's supposed to.</li>
	    <li>There is now an automatic invoke ID for the send window.  It is incremented when the Send button is clicked.  The value is saved in the preferences (registry), so it comes back for the next VTS launch.  Note that this is NOT the same invoke ID that will be used by a built-in device object, and that is by design.</li>
		<li>Now checks the version of BACMACNT.SYS it can find.  Only version 3.0 works.</li>
		<li>Added decoding of UTCOffset and DayLightSavingStatus to the UTCTimeSynch service.</li>
		<li>Changed the UTCOffset range from +/- 720 to +/-780.</li> 
		<li>Line numbers have been added to script windows, with a way to "Go to" a line number via a new menu option.</li>
		<li>The font was changed in script windows so that consecutive dashes would not appear as one long dash.</li>
		<li>A menu item "Export" has been added for exporting the session contents to an ASCII file.  The ASCII file includes the summary and detail information.</li>
        <li>Fixed a bug in decoding the BACnetEventTransitionBits datatype.</li>
        <li>The 3 panes of the main view (summary, detail, and hex view) can each be sized, rearranged, and selectively hidden. </li>
		<li>A statistics view has been added that shows statistics in real time. The statistics include:
		   <ol>
		      <li>The overall traffic load</li>
			  <li>The packet count of one or several kinds of messages. For example, how many Who-Is packets are received/sent, how many Alarm & Event packets are received/sent etc. </li>
			  <li>The packet count of packets that fall into 3 different user-specified size categories. </li>
		   </ol>
		</li>
		<li>When the user double-clicks on a line in the outline view of a script, the script view will jump to the corresponding line. </li>
		<li>Support was added for the Active_COV_Subscriptions Property of the Device Object. </li>
		<li>Support was added for the Profile_Name Property.</li>
       </ul>

     <h2>3.1.9</h2>
     <ul> 
		<p><li>Added PTP Support
			<p>The PTP data link layer has been added in this release. It launches a separate process
			and displays transmit and receive logs that are specific to PTP.  There has been very
			little testing on this feature, so please use it with caution.  If any bugs are discovered
			in the PTP implementation, 
			please report them <a href="http://sourceforge.net/tracker/?group_id=27326&atid=390005">here</a>.    
         </p>
		</li></p>
		<p><li>Fixed problems parsing these BACnet Properties:
			<ul>
			<li>Recipient_List</li>
			<li>Weekly_Schedule</li>
			<li>Exception_Schedule</li>
			<li>List_Of_Object_Property_References</li>
			</ul>
		</li></p>
		<p><li>Fixed a problem in the vertical scrolling of the Script Edit view.</li></p>
		<p><li>Fixed a problem that caused VTS to crash if a line in the detail view of the sniffer was too long.</li></p>
		<p><li>590282: Added an easy way for the user to delete the current log.</li></p>
		<p><li>598977: Fixed a problem with the Names configuration dialog box not refreshing properly.</li></p>
		<p><li>Packaged the correct version of BACMACNT in this release.  This should allow users 
		running Windows NT to utilize the BACnet/Ethernet data link, but there have been many problems
		reported with this, and it definitely does not work on Windows XP systems.  The eventual
		solution is to replace BACMACNT with a <a href="http://winpcap.polito.it">WinPcap</a> library interface,
		which will also enable promiscuous BACnet/IP sniffing.</li></p>
		<p><li>User interface enhancements to the ReadPropertyMultiple, ReadPropertyMultipleAck,
		and WritePropertyMultiple Send dialogs.
			<ul>
				<li>Increased the size of the drop down combo boxes to show more Properties.</li>
				<li>When adding a new Property, the default of Present_Value is automatically added, 
				then the user must edit this addition to the Property of his/her choice.
				Previously, a blank was added to the list of Properties, and the user could get
				confused as to whether the Add button had any effect.</li>
			 </ul>
		</li> </p>
		<p><li>General cleanup of many list controls.
			<ol>
				<li>ReadBDTAck<ul>
					<li>Added controls for IP / Port creation instead of edit box</li>
					<li>Address defaults and appears in list, rather than empty space item</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>ReadFDTAck<ul>
					<li>Added controls for IP / Port creation instead of edit box</li>
					<li>Address defaults and appears in list, rather than empty space item</li>
					<li>List keeps selection, preventing GPF in removals of list items</li>
					<li>Changed tab order of dialog items</li></ul>
				 </li>
				<li>IAmRTN, RouterBusyToNetwork, RouterAvailToNetwork, InitRT, InitRTAck<ul>
					<li>Default '1' for DNET address, port (where applicable) default to 0xBAC0</li>
					<li>Address defaults and appears in list, rather than empty space item</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>UnconfCOVNotification, ConfCOVNotification, CreateObject<ul>
					<li>Default 'Present_Value' for property</li>
					<li>Property value appears in list, rather than empty space item</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>VTClose, VTCloseAck<ul>
					<li>Default '1' for Session ID</li>
					<li>ID appears in list, rather than empty space item</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>WriteFile, ReadFileAck<ul>
					<li>Default '(record data)' as string for adding data</li>
					<li>Character data no longer needs to be placed in quotes in edit box (see below)</li>
					<li>Data appears in list instead of empty space</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>ReadPropMult, ReadPropMultAck, WritePropMult<ul>
					<li>Default object ID</li>
					<li>Defaulted data appears in list instead of blank space item</li>
					<li>Resized property drop-downs</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>GetAlarmSummaryAck, GetEnrollmentSummaryAck<ul>
					<li>Default object ID and state</li>
					<li>ID and state appear in list instead of empty space</li>
					<li>Enabled transition checks - checks were previously always disabled </li>
					<li>List keeps selection, preventing GPF in removals of list items</li>
					<li>Changed 'property' label to 'Event State' for proper field</li></ul>
				</li>
				<li>ComplexObjectType<ul>
					<li>Default 'Present_Value' in list</li>
					<li>Property appears in list instead of empty space</li>
					<li>Disabled controls on dialog start when no items in list (formerly enabled)</li>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
				<li>VTSAny<ul>
					<li>List keeps selection, preventing GPF in removals of list items</li></ul>
				</li>
		    </ol>
		</li></p>
		<p><li>511345, 511412:  Charstring handling
			<p>
			User was unable to see char string entered for passwords in DCC & Charstring was apparently
			not sent to device in WP/WPM.  This problem was actually caused by the method for entering
			char strings in edit boxes.  Single or double quotes were required within the edit box to
			properly input the desired text for passwords, messages, names, etc..  Strings were using the
			script parser to identify strings but this is not necessary in the UI.  Edit fields requiring 
			strings throughout VTS have been altered accept what is entered.  If quotes are present, the quotes
			are assumed to be part of the text and sent to the device in the relavent BACnet message.  This
			change effects the following areas:
			</p>
			<ul>
			<li>SendAckAlarm -> ack source</li>
			<li>ConfirmedEventNotification -> message text</li>
			<li>ConfirmedTextMessage -> character class, text message</li>
			<li>DeviceCommunicationControl -> password (original bug report)</li>
			<li>IHave -> object name</li>
			<li>ReinitializeDevice -> password</li>
			<li>Test? -> character string</li>
			<li>UnconfirmedEventNotification -> message text</li>
			<li>UnconfirmedTextMessage -> character class, text message</li>
			<li>WhoHas -> object name</li>
			<li>Any -> character string</li>
			</ul>
		</li></p>
		<p><li>444134: Auto Segmentation Support
			<p>
			User can now select a device from the Send menu, or the port drop down menu.  There is a new 
			Device page which is looking for a destination address (type, network, and address) and the 
			outgoing APDU will be set to that address.  The device object will take care of segmentation,
			retries, etc, as necessary.  Properly configuring a built-in device object and binding it to a 
			port will be part of a separate document. 
			</p>
		</li></p>
		<p><li>511406:  Status flags in a variable comp fails
			<p>
				Comparisons for status flags in RP/M, WP/M work properly now.  This problem was caused
				by reading one byte passed the encoded PDU for the bitstring.  The comparison failed 
				because the tag was being interpreted as part of the incoming bitstring.
			</p>
		</li></p>
		<p><li>508646:  rp to UTC_Offset fails in a script
			<p>
				Comparing the returned UTC_Offset value in a script to EPICS failed because the data type
				used in VTS's internal structures for UTC_Offset was a float instead of int.  This has been
				corrected by changing it's internal type to 'ssint' and processing accordingly.
			</p>
		</li></p>
		<p><li>508643:  VTS3 unable to read device-address-binding(RP, RPM)
			<p>
				'Property value not known' was returned correctly when comparing device-address-binding to EPICS when
				the value was '?'.  It returned this error incorrectly when the EPICS value was defined as empty ().
				It now compares the valid empty condition.  This error would also show up on other non-primitive data types
				whose value could be empty ().
			</p>
		</li></p>
		<p><li>508640, Array bugs in rp (1E,1F,1G)
			<p>
				<p><u>Case 1E</u> has been fixed by creating a BACnet type class structure that will facilitate easier type
				comparisons.  Cases 1F and 1G are errors in the script parser that don't deal with array
				indices.  (See below)</p>

				<p>Reworked implementation for comparing data in EXPECT statements from values retrieved from EPICS and
				specified in scripts.   Any AL value being compared to EPICS data was using a method to match encoded
				streams.  This scheme would fail in cases where numbers used different encoding sizes, different type
				comparisons that are legal (such as float vs. null in priority arrays) and many other.  More detailed
				comparisons were impossible with this method because VTS had no way of determining the type of data 
				and could not determine the proper end of the stream, among other reasons.  </p>

				<p>To implement type specific comparisons for all possible BACnet data types, including arrays, lists and 
				complex structures, the c++ class representation for BACnet data types has been extended.  These 
				classes serve as a foundation that allows the use of more tools (MFC, polymorphism, etc.) to 
				facilitate feature additions and more flexibility where BACnet data type are concerned.  Type specific 
				matching methods, display methods, decoding, assignment and comparative operators are now available.  </p>

				<p>Using these classes to perform decoding and comparisons in the heart of EXPECT statements required 
				the need for a retreval method to access the internal EPICS structures and convert them to BACnet 
				type classes.   The immediate result of these changes can be seen in more meaningful text in test 
				fail results.  In addition, comparisons can now be made to the following data types: 

					<ul>
					<li>Unsigned values - all sizes.</li>
					<li>Integer values - all sizes.</li>
					<li>Real and doubles.</li>
					<li>Priority arrays for floats, reals, enumerated and NULL choices.  Indexes not supported yet from sript parser yet but comparisons are ready.</li>
					<li>Boolean.</li>
					<li>Bit strings.</li>
					<li>Object IDs.</li>
					<li>Character strings - any size.</li>
					<li>Enumerated values.</li>
					<li>Date values - all comparison operators.</li>
					<li>Time values - all comparison operators.</li>
					<li>DateTime values - all comparison operators.</li>
					<li>DateRange - all comparison operators (where applicable).</li>
					<li>Calendar Entries and lists.</li>
					<li>Device Address Bindings.</li>
					<li>Array of object identifiers.</li>
					<li>Arrays and lists of unsigned values.</li>
					<li>Arrays of text for active/inactive.</li>
					</ul> </p>

            <blockquote><font color="#777777">
            Notes for future enhancements:

				<p>The following type comparisons are <b>not</b> implemented yet:
					<ul>
					<li>List of read access specs.</li>
					<li>Action commands and arrays of action commands.</li>
					<li>VT classes.</li>
					<li>Event parameters.</li>
					<li>Session keys.</li>
					<li>Time Synch recipients.</li>
					<li>Recipients.</li>
					<li>List of Recipients.</li>
					<li>Array of exceptions schedule events.</li>
					<li>Array of weekly schedules.</li>
					<li>List of object property references.</li>
					<li>Setpoint reference.</li>
					<li>List of active VT sessions.</li>
					</ul> </p>
				<p>Adding support for these remaining types is simply a matter of constructing the object from the 
				EPICS internal structures and decoding the object from a stream.  The mechanisms for performing the 
				comparisons are already in place.  The development of support for proprietary objects in EPICS 
				and scripts will be assisted by BACnet classes as well. </p>

				<p>Other benefits of this work will be seen later as the EPICS store gradually converts to store 
				data internally in these classes.  The greatest benefit to this foundation work will be seen as data 
				becomes extractable from Complex Acks either compared, tested or even assigned to variables of complex
				types in scripts.  Additionally, script parsing will be effected by these changes once all of the 
				data types are supported and proper scanning methods for each will allow a single source code source 
				for the creation of such objects. </p>
            </font></blockquote>

				<p>Most of the SEND methods have been altered to retrieve EPICS data using these classes as well as 
				creation and encoding of send streams from these object types.  Specifically, the following classes 
				have been added or altered: </p>
					<ul>
					<li>All BACnet classes enhanced with Runtime type declaratives, ToString and Match virtuals.</li>  
					<li>Most classes now have constructors that take an APDUDecoder to construct the value from an 
					encoded stream.</li>  
					<li>BACnetEncodeable now decends from CObject, added Match and ToString virtuals.</li>  
						<li>BACnetAddr</li>
						<li>BACnetUnsigned</li>
						<li>BACnetCharacterString</li>
						<li>BACnetBinaryPriV</li>
						<li>BACnetCalendarArray</li>
						<li>BACnetCalendarEntry</li>
						<li>BACnetDate</li>
						<li>BACnetDateTime</li>
						<li>BACnetDateRange</li>
						<li>BACnetTime</li>
						<li>BACnetTimeStamp</li>
						<li>BACnetWeekNDay</li>
						<li>BACnetObjectIDList</li>
						<li>BACnetGenericArray</li>
						<li>BACnetObjectContainer</li>
						<li>BACnetAnyValue (to facility "any" type flexibility - but mostly to encapsulate dynamically 
					        allocated objects for proper destruction when there's so much 'throwing' goings on...).	</li>
					</ul>

				<p><u>Case 1F</u> (test for size of array [0]) and <u>case 1G</u> (test of single index value in array [int]) have
				also been fixed.  Indexing into array properties is now supported in the following manner:
<pre>{property[int]}
    - or -
{property[var]}
</pre>
				The index must either be a literal integer or a variable which resolves to an integer.
				</p>
			</p>
		</li></p>
		<p><li>617618:  RPM MAX script crashes VTS
			<p>
				This problem was caused during an attempt to reallocate an APDU buffer to accomodate a larger
				size APDU.  The problem has been fixed.  VTS no longer crashes.  Proper segmentation should occur.
			</p>
		</li></p>
		<p><li>618176: EXPECT needs "Don't Care" arguments
			<p>
				<p>This feature was added to allow a script to test for the correct tagging 
				in an EXPECT statement without regard to the actual data value.  Expressions within an EXPECT statement now support the don't care operation.  
				Equations and values can be specified as don't care in one of the following ways:</p>

				<ol>
				<li>Replace the value in the right side of an expression with '?'. &nbsp;&nbsp;&nbsp;&nbsp;For example:
<pre>Unsigned = 1, ?
Bitstring = 2, ?
Real = 3, ?
</pre>


				In the example above, the EXPECT statement will fail if the packet does
				not contain a context 1 unsigned integer, followed by a context 2 bitstring, followed
				by a context 3 real, but the actual values of each of the data values is discarded.  This can 
            prove useful if one or more of the parameters expected cannot be
            pre-determined, such as a time stamp.  If the expected data is application tagged instead
            of context tagged, then the following is also valid:
<pre>Unsigned = ?
Bitstring = ?
Real = ?
</pre>
				
				'?' can also be used for always matching addresses
				returned for EXPECT statements when applied to:  
				<ul>
					<li>WriteBDT</li>
					<li>BVLLResult</li>
					<li>ReadBDTAck</li>
					<li>ForwardedNPDU</li>
					<li>RegisterFD</li>
					<li>ReadFDTAck</li>
					<li>DeleteFDTEntry</li>
					<li>WhoIsRouterToNetwork</li>
					<li>IAmRouterToNetwork</li>
					<li>ICouldBeRouterToNetwork</li>
					<li>RejectMsgToNetwork</li>
					<li>RouterBusyToNetwork</li>
					<li>RouterAvailToNetwork</li>
					<li>InitializeRoutingTable</li>
					<li>EstablishConnectionToNetwork</li>
					<li>DisconnectConnectionToNetwork</li>
				 </ul>
				
				 
				<p>'?' is not valid for AL type data
				where the datatype is determined by the EPICS reference on the right side of the expression. 
				'?' can only be used if the left side of the expression specifies the datatype.</p>
				</li>

				<li>Use of the don't care operator: '?=' &nbsp;&nbsp;&nbsp;&nbsp; For example:
<pre>Unsigned ?= 20
Bitstring ?= F, T
AL ?= {EPICSReference}
</pre>

				<p>Use of the don't care operator '?=' within an EXPECT statement will cause the data stream to be
				parsed correctly according to the data type but the value will not be tested.  This operator
				works on primitive types (Unsigned ?= 20) as well as the AL data.  The value on the right of the operator must be valid for the datatype.  EPICS references for AL
				expressions must be valid in order to determine the data stream type. </p>
            
            <p>The '?=' operator
				is more flexible than the '?' data matching method, but the '?' is provided for
				clarity in simpler expressions.  For example:
<pre>Unsigned = ?
</pre>
is easier to understand than:
<pre>Unsigned ?= 9
</pre>
where the '9' is superfluous.  But both formats accomplish the same thing.

				</p>
				</li>
				</ol>
			</p>
		</li></p>
		<p><li>Date / Time Improvements
			<p>Several changes have taken place in the handling of the primitive Date and
				Time data types.  The listing here does not include other improvements that
				were made concerning script variables (reported later in this text).  Unless
				noted, both the Date and Time data type handling were affected equally by
				these corrections and enhancements.</p>
			<ol>
			<li>The Date and Time data types were not accepting a script variable
substitution when used in Send and Expect statements.  Full support for
receiving Date and Time values from variables has been added.  Substitutions
will take the standard form in Expect and Send statements:
<pre>Date = tag, VAR
Date = VAR
Time = tag, VAR
Time = VAR
Date = VAR   (where VAR = tag, [value])
Time = VAR   (where VAR = tag, [value])
</pre>
            </li>
			<li>The Date and Time data types were having trouble comparing don't care
             values '?' or '*'.  '?' characters in a field of a Date or Time variable are now 
             considered to be wildcards that match any value in the corresponding field of the 
             Date or Time being compared, whereas the '*' 
             character <b>only</b> matches the BACnet "unspecified" value of X'FF'. 
             In other words, '*' is not a wildcard, but a symbol that represents the 
             unspecified X'FF' value.</li>
			<li>Added support for the don't care value that other data types recently
support.  '?' can be substituted for a Date or Time value and the comparison
will return true.  Ex:   (Date = tag, ?) will pass the comparison in an
Expect statement.  ? substitutions are not valid in Send statements.</li>
			<li>Date and Time values specified in EPICS that had don't care values would
not be allowed in references.  Date = {Local_Date} would fail because the
script executor thought data wasn't defined in EPICS for that property.
This restriction has been removed and now supports all combinations of don't
care specifications (?/?/?).</li>
			<li>Full comparison support has been added to the Date and Time primitive
types.  &lt;, &gt;, =, !=, &lt;=, &gt;=, ?= and &gt;&gt; (see below) have been added.  This
includes date and time values that have the don't care specification.</li>
			<li>The Date and Time primitive types had various parsing problems.  This
particularly true when Date and Time values were used as expression
parameters when other parameters were present.  Tag values were especially
troublesome because they introduce another parameter in the expression that
is only separated by a comma, which is also used to separate values in the
date. Here is an example of a pre-3.1.9 assignment:
<pre>Date = tag, dow, n/n/n
</pre>
			<p>With this syntax, parsing the day of week and/or the tag was difficult due to data values for
complex types being mixed with parameter in an expression.  These problems
have been cleaned up by adding the following requirements to data types
whose ASCII format requires multiple values.  These kinds of values are
considered complex data types and the Date and Time types fall into this
category.  Other values (lists, calendar entries, and other not-yet
implemented value specifiers) also fall into this category.</p>

				<b>Text representations of complex data types now require the use of brackets '[]' to separate
				their data from other parameters.</b>  The brackets are required even if no other parameters
				in an expression are present.  The Date and Time text representations now take the following
				form:
<pre>Date = [<i>dow</i>, <i>mm</i>/<i>dd</i>/<i>yy</i>]
         -or-
Date = [<i>dow</i>, <i>mm</i>-<i>dd</i>-<i>yy</i>]
Time = [<i>hh</i>:<i>mm</i>:<i>ss.HH</i>]
</pre>
					<ul>
					<li><tt><i>dow</i></tt> = 3 characters (case insensitive) for MON, TUE, WED, THU, FRI, SAT, SUN.
						  This value must be present and can be substituted with ? as in
						  <tt>[?, mm/dd/yy]</tt>.  A comma separates this value and leading and trailing
						  spaces between each atomic type are ignored 
						  (i.e. <tt>[?   ,   mm  /  dd  / yy]</tt> is the same as <tt>[?,mm/dd/yy]</tt>).</li>
					<li><tt><i>mm, dd, yy, hh, mm, ss, HH</i></tt> = numeric values with leading or no zeros.
				          Values are checked for validity in every case except invalid dates as
						  a whole (Feb 31st).</li>
					<li><tt><i>yy</i></tt> = Year specification given as either the full year (2002) or a partial
						  year (02).  Values interpreted as partial years range from 1941 to 2040. '23' indicates 2023 whereas '45' indicated 1945.  '98' indicates 1948 and
'00' indicates 2000.</li>
					<li><tt><i>HH</i></tt> =  hundredth value in the range 0 - 99.  This value is optional in the text
						  representation.  If the period is present in the text, the value MUST follow
						  or a parsing error is generated and the Time is invalid.</li>
					</ul>
				<p>Any and all values can be substituted with the don't care value ?.  For example:  <tt>[12:?:44.?]</tt>.
				Enclosing these complex representations inside brackets gives clarity to expressions with
				multiple parameters as in the case of tag specifications:
<pre>Date = tag, [TUE, 11/4/02]
         -or-
VAR = [TUE, 11/4/02]
Date = tag, VAR
</pre>
				</p>
				<p>Bracketing this compound data can be
				nested as in the case of the text representation for a DateTime and DateRange:
<pre>DateTime  = [DATE, TIME]   = [[dow, mm/dd/yy], [hh:mm:ss]]
DateRange = [DATE1, DATE2] = [[dow, mm/dd/yy], [dow, mm/dd/yy]]
</pre>

				<p>DateTime and DateRange are not considered primitive types and currently can
only be used when referencing EPICS data and so a text representation for
these types has not been needed as yet.  The addition of variable
assignments tends to usher in the requirement for these representations.
How text representations are interpreted as certain data types requires a
solution, as referenced in the following section on variable assignments.</p>

<p>One final note on the bracketing of compound data is that, like quotes for
strings, the brackets are only necessary in situations where other types of
data may be read as well.  Brackets are not necessary when date and time
values are specified inside edit fields within the VTS user interface.  They
are, however, necessary in scripts and subsequently, like quotes, necessary
inside script parameter data, since this data is partially parsed.</p>


			</li>
		</ol>
		</li></p>
		<p><li>444200: Extract data from incoming packets
			<p>
				Support for stuffing incoming data elements into script variables has been added throughout
				the EXPECT statement, except where noted.  Syntax for the new operator '>>' in assignments
				take the following form:
<pre>Keyword >> VAR
         -or-
Keyword >> tag, VAR
</pre>
				<p>The above assignments will place a text representation of the incoming data given by the keyword into the
				script parameter VAR.  The assignment that contains the 'tag' parameter is used when the encoded data is expected to be context tagged instead of application tagged. <b>The VAR parameter MUST be previously created in the SETUP section
				of the script or an error will be reported. </b></p>

				<p>The first form assumes no tag is present and the data is removed from the
				stream and placed in the VAR.  If a tag is expected (as found in the
				incoming packet), and error will be reported.  The second form allows the
				testing of a context tag first and then an assignment into the variable.
				The tag will NOT be present in the new assignment.  The contents of VAR will
				NOT be interpreted prior to assignment.  This is relevant because it is
				possible to have statements:</p>
<pre>VAR = tag, value
Keyword = VAR
   ... which resolves to:
Keyword = tag, value
   ... and the tag is tested.
</pre>
<p>Thus, it would be conceivable to allow:</p>
<pre>VAR = tag, VAR2
Keyword = VAR
   ... which might resolve to:
Keyword = tag, VAR2
   ... and finally place the decoded value in the VAR2 parameter. <b>But this is not supported.</b>
</pre>
				<p>The data will be placed in script parameters in a text format that can be
re-decoded for use in comparisons in other expressions.  Each text format
will be determined by the appropriate type.  The following assignments are
legal for these data types:</p>
  				<blockquote>
				<p><tt>Boolean >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns: Set or Reset</p>
				<p><tt>Unsigned >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns: Number</p> 
				<p><tt>Integer >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns: Number</p> 
				<p><tt>Real >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns: Real</p> 
				<p><tt>Double >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns: Real</p> 
				<p><tt>OctetString >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  X'nnnnnn'</p> 
				<p><tt>BitString >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  B'0102010'</p> 
				<p><tt>CharacterString >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  "Char"</p> 
				<p><tt>Date >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  [dow, mm/dd/yy]</p> 
				<p><tt>Time >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  [hh:mm:ss.HH]</p> 
					<hr>
				<p><tt>Enumerated >> VAR</tt>&nbsp;&nbsp;&nbsp;;Assigns:  Number or KEYWORD if enumeration table is known
(as in the case of Boolean).  Support for this can be incremental.</p> 
					<hr>
			        <p><tt>Object >> VAR</tt></p>
					<p>-or-</p>
					<p><tt>Object >> tag, VAR</tt></p>
					  Expects and Object Identifier and assigns 'OBJECT-TYPE, Number'  to VAR.  In other words, this type of assignment will place the object type keyword AND the object instance number
					  inside the script parameter value. (Note that the object really falls
in the compound data class and would best be served by bracketing the type
and instance together [type, instance].  This was NOT implemented because
too many scripts would require alteration). 
				<hr>
  				
			        <p><tt>Property >> tag, VAR	</tt></p>
					  Expects a context tagged Property Identifier and assigns it to VAR. The property keyword (i.e. PRESENT_VALUE) will be placed inside the variable. 
					  This will be properly decoded and compared in other equality expressions in the current
					  or upcoming EXPECT statements.
				<hr>
				<p>(OpeningTag and ClosingTag do not support the assignment operator).</p>
				<hr>

				<p><tt>VERSION >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>PRIORITY >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>DER >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Boolean (Set or Reset)</p>
				<p><tt>DNET >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>SNET >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>HOPCOUNT >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>NEGATIVEACK >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Boolean</p>
				<p><tt>SERVER >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Boolean</p>
				<p><tt>INVOKEID >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: Number</p>
				<p><tt>ABORTREASON >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: EnumeratedKeyword (SEGMENTATION-NOT-SUPPORTED)</p>
				<p><tt>REJECTREASON >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: EnumeratedKeyword (INCONSISTENT-PARAMETERS)</p>
				<p><tt>WINDOWSIZE >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Number</p>
				<p><tt>SEQUENCENR >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Number</p>
				<p><tt>SETACCEPTED >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Boolean</p>
				<p><tt>MOREFOLLOWS >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Boolean</p>
				<p><tt>ERRORCHOICE >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: EnumeratedKeyword ()</p>
				<p><tt>SEGMESSAGE >> VAR</tt>&nbsp;&nbsp;&nbsp;; Assigns: Boolean</p>
				<p><tt>SERVICE >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: EnumeratedKeyword (ACKNOWLEDGEALARM)</p>
				<p><tt>PDU >> VAR</tt>&nbsp;&nbsp;&nbsp;;  Assigns: EnumeratedKeyword (CONFIRMED-REQUEST)</p>
				<hr>
			    <p><tt>MAXSIZE >> VAR</tt></p>
					Assigns: Enumeration of ("50", "128", "206", "480", "1024", "1476")  or Number if less than 16.
			 If VAR now contains a number, it will be converted to code if VAR is then used in a SEND.
				<hr>
			        <p><tt>NETWORK >> VAR</tt></p>
					Assigns: CharacterString for currently defined port (in quotes).
				<hr>
			        <p><tt>SADR >> VAR</tt></p>
			        <p><tt>DADR >> VAR</tt></p>
					<p>Both of these assign a CharacterString for the defined name of the device if known,
OctetString if not.</p>
<p>An error was discovered and corrected concerning the specification of DNET/DADR and SNET/SADR
			pairs in the script.  The test for whether or not these pairs were present in the received
			packet was being determined by whether or not the DNET/DADR keywords were supplied in the
			script.	 This was causing the script to have hard-coded expectations about whether the IUT was 
			behind a router or not.</p>
				<hr>
			        <p><tt>BVLCI >> VAR</tt></p> Assigns: BVLCI type, i.e. READ-BROADCAST-DISTRIBUTION-TABLE-ACK {,host/net:port}*
			        <p><tt>MESSAGE >> VAR, ?, ?, ?</tt></p>	Assigns the network layer message type to VAR.  
					<p><b>A special note about these two keywords:  MESSAGE and BVLCI. </b> These
keywords have parameters that follow which dictate how the values are
extracted from the received packet.  As VTS is currently coded, assignment
of all of the parameters into a VAR is impossible because the number of
parameters that are specified in an equality expression determines what data
to extract.  For example: Assignments of </p>
			        <p><tt>BVLCI >> VAR</tt></p> ... where the BVLCI received is READ-BROADCAST-DISTRIBUTION-TABLE-ACK
{,host/net:port}*
<p>...would fail because the number of entries into the table is matched and
determined by the number of parameters given in the expression.    Although simpler
assignments are possible with other kinds of BLVCI types (BVLC-RESULT,
rslt), it is not clear whether a variable assignment of the entire set of
parameters or just the BLVCI type would be most useful further in the
script.  For this reason, the current implementation supports the assignment
of the type ONLY into the script variable, using a syntax such as:
</p>
			        <p><tt>BVLCI >> VAR, ?, ?, ?</tt></p>

<p>The contents of VAR will have the enumerated keyword
READ-BROADCAST-DISTRIBUTION-TABLE-ACK and no further parameters.  The use of
the don't care value is required for types that have a variable number of
arguments so the receive packet can be properly decoded.  Looking into how
this could be implemented in such a way as to not depend on the parameters
supplied in the script to properly decode the received packet is probably
warranted.</p>

<p>All of the parameters must be specified, even in simple cases such as:
</p>

			        <p><tt>BVLCI >> VAR, rslt</tt></p>

<p>...where the type is BVLC-RESULT.   After the VAR is stuffed with the BLVCI
type, 'rslt' will be compared to the received result as if the equals
operator was used.
</p>
<p>The MESSAGE keyword for determining network layer message types:
</p>
			        <p><tt>MESSAGE >> VAR, ?, ?, ?</tt></p>
<p>... where the type is I-AM-ROUTER-TO-NETWORK would require the specification
of all of the networks the sender is a router to (or specified as don't care
values).  VAR would be assigned with the network message enumerated keyword
(i.e. I-AM-ROUTER-TO-NETWORK).  An alternate way of handling this <b>in future releases</b> might be to allow the assignment of multiple values into multiple
variables with a single assignment expression.  Like this:
</p>
			        <p><tt>MESSAGE >> VAR1, VAR2, VAR3, VAR4, etc.</tt></p>
					<p>-or-</p>
			        <p><tt>MESSAGE >> I-AM-ROUTER-TO-NETWORK, VAR, ?, ?</tt></p>
					<p><b>But both of these forms are currently unsupported.</b></p>

				<hr>
				  
<!--			</blockquote>    -->
		</li></p>
	 </ul>

     <h2>3.2.0</h2>
<ul>
  <p><li>
  				<blockquote>
				618172: Conditional flow control for scripts
<p>Support for the IF statement has been added. The statement is a pre-processor form used to 
control  compilation during the "Syntax Check" function. The
expression in the conditional will not be evaluated at script 
execution.  Syntax for the conditional compilation will take 
the form:</p>

<pre>IF (expression {[OR | AND] expression} )
.
{ELSEIF (expression {[OR | AND] expression} )}
.
{ELSE} 
.
ENDIF
</pre>

<p>The pre-processor will evaluate the expressions contained 
within the perenthesis following the 'IF' keyword before 
scanning the next line.  If the expression evaluates to true,
all
of the following lines up to the ENDIF keyword (or ELSEIF or 
ELSE, if supplied) will be included in the compile.  Multiple 
expressions can be evaluated.  Evaluation will occur left to 
right until a false condition is detected.  Parenthesis for 
logical grouping is not supported.</p>

<p>The ELSEIF and ELSE clauses are optional (indicated 
by '{}').  Only one ELSE clause can be present within an IF 
block but multiple ELSEIF clauses can exist.  Each of the 
keywords must appear at the first element on a line.  Once a 
true condition in any clause is found, any remaining ELSEIF 
or ELSE clauses will not be evaluated and the syntax for 
these clauses will not be checked.</p>

<p>The expressions will take the following form:</p>

<pre>VAR/Value operator VAR/Value
</pre>

<p>Where VAR/Value is either a script variable name that has 
already been assigned in the SETUP section or a literal 
value.  Any expression referencing a script variable that has 
not been defined will evaluate as if the variable is an 
enumeration keyword.  All literals or variables must evaluate 
to one of the following types:</p>

<pre>Boolean (TRUE, T, FALSE, F, Y, YES, N, NO) {=, !=}
Enumeration (NAME) {=, !=}
Integer (-1, 0, 1, etc.) {=, !=, <, <=, >, >=}
Unsigned (0, 1, 2) {=, !=, <, <=, >, >=}
CharacterString ("Twinkies") {=, !=, <, <=, >,>=}
</pre>

<p>Note that use of Real, Double, Null, BitString, OctetString, 
Date, Time, ObjectIdentifier, DeviceIdentifier, 
PropertyIdentifier type are not supported in IF expressions at 
the present time.  The assignment operator '>>' and don't 
care operator '?=' are unsupported in IF expressions.  Use of 
the don't care value '?' is supported and will always match 
whatever type and value it is compared to, regardless of the 
operator used.   i.e.  VAR != ?, where VAR = 20 or any value 
will be true. </p>

<p>Enumeration types will be supported.  All unquoted names 
will be treated as an enumeration type and a conversion to 
caps and '_' to '-' will be performed prior to evaluation.  It
is
not necessary to supply a valid enumeration name because 
all names that do not resolve to parameters will be treated 
like an enumeration. </p>

<pre>VAR = I-AM-ROUTER-TO-NETWORK
VAR = BOGUS-NOT-FOUND-ENUMERATION
</pre>

<p>Parameters that have either been changed by the user or 
changed by a previous script execution (item shows blue in  
parameter list) will use the new value for IF comparisons.  
A 'reset' must be performed to have the IF conditional use the 
script assigned value for comparison. </p>

<p>IFs can be nested.  Since the IF statement is used for 
conditional compilation, the IF block can span multiple script 
statements, occur within a SEND or EXPECT statement, or 
straddle the beginning and/or end of SEND or EXPECT 
statements.</p>
</li>

<p><li>444152: New CHECK statement

<p>Added CHECK statement to script commands that will popup 
a modal dialog box and allow the user to PASS or FAIL the 
script test.  Script execution is halted while the dialog is
up. Syntax for the CHECK statement is as follows:  </p>

<pre>CHECK "Title" (
   "Text line"
    ...
   "Text line"
   )
</pre>

<p>Usage details can be found in a usage document attached to 
the MAKE item, 44153. </p>
</li>

<p><li>444153: New non-modal MAKE statement
<p>
Added MAKE statement to script commands.  It will pop up 
a dialog with a supplied message and allow the user to alter 
a condition that generates a receive packet.  When followed 
by an EXPECT statement, script execution continues with 
indefinately extended EXPECT timers.  Syntax is exactly like 
the CHECK statement with the exception of the keyword 
MAKE.

<pre>MAKE "Title" (
   "Text line"
    ...
   "Text line"
   )
</pre>

<p>Usage details can be found in the document attached to the 
sourceforge item. </p>
</li>


<p><li>508582: (*Add) Inefficient drop down windows
<p>Now the send page such as "CSendNPCI", "CSendBVLCI", "CSendReadProp", "CSendReadPropACK", "CSendReadPropMult", "CSendReadPropMultACK", "CsendWriteProp", "CSendWritePropMult", "CSendWritePropMultError"  can remember the values of the past 5 packets. 
</p>

<p>And when tester sends an request with  a particular object and property in one of send window:  "CSendReadPropMult", "CSendReadPropMultACK" and "CsendWritePropMult" windows, the others will have the same settings.
</p>
</li>

<p><li>468378: Schedule Object EPICS Parsing Probs
<p>We have used other way to fix this bug without type identifier
in
the EPICS. The value of present-value will be parsed according 
to value of list_of_object_property_reference.
Now VTS3 can parse the schedule object defined in EPICS 
correctly. However we found although we have fixed this bug, 
there are some problems in handling packet expected, we 
modified the struct of schedule object, and now VTS3 can handle 
three kinds of data type: Binary value, unsigned word and float.
</p>
</li>

<p><li>444148: Read-all test
<p>
Now VTS3 can support read-all test. A menu item "read all property" has been added into menu "script", after loading EPICS successfully, this menu will be enabled. When you click this menu, VTS prompts you to input network number and destination address, after then VTS3 create a temp VTS3 script in a new script document, you can save this script file. If you don't save this file, VTS3 will delete this temp file. 
Note: At present, VTS3 only supports read all test over BACnet/IP.
</p>
</li>

<p><li>444157: EPICS consistency checks
<p>
Now VTS3 can support more consistency check function. EPICS consistency check is in accordance with BACnet standard 1995, have finished the following items consistency check.:
</p>
<ol>
<li>All object types required by the specified conformance class shall be indicated as supported in the Standard Object Types Supported section of the EPICS.
</li>

<li>A minimum of one instance of each object type required by the specified conformance class shall be included in the test database.
</li>
<li>The Object_Types_Supported property of the Device object in the test database shall indicate support for each object type required by the specified conformance class.
</li> 
<li>All application services required by the specified conformance class shall be indicated as supported in the BACnet Standard Application Services Supported section of the EPICS with Initiate and Execute indicated as required by the conformance class.
</li>
<li>The Application_Services_Supported property of the Device object in the test database shall indicate support for each application service for which the specified conformance class requires support for execution of the service.
</li>
<li>All object types required by the specified functional groups shall be indicated as supported in the Standard Object Types Supported section of the EPICS.
</li>
<li>A minimum of one instance of each object type required by the specified functional groups shall be included in the test database.
</li>
<li>The Object_Types_Supported property of the Device object in the test database shall indicate support for each object type required by the specified functional groups.
</li>
<li>All application services required by the specified functional groups shall be indicated as supported in the BACnet Standard Application Services Supported section of the EPICS with Initiate and Execute indicated as required by the functional groups.
</li>
<li>The Application_Services_Supported property of the Device object in the test database shall indicate support for each application service for which the specified functional groups require support for execution of the service.
</li>
<li>The object types listed in the Standard Object Types Supported section of the EPICS shall have a one-to-one correspondence with object types listed in the Object_Types_Supported property of the Device object contained in the test database.
</li>
<li>For each object type listed in the Standard Object Types Supported section of the EPICS there shall be at least one object of that type in the test database.
</li>
<li>There shall be a one-to-one correspondence between the objects listed in the Object_List property of the Device object and the objects included in the test database. The Object_List property and the test database shall both include all proprietary objects. Properties of proprietary objects that are not required by BACnet Clause 23.4.3 need not be included in the test database.
</li>
<li>For each object included in the test database, all required properties for that object as defined in Clause 12 of BACnet shall be present. In addition, if any of the properties 
supported for an object require the conditional presence of other properties, their presence shall be verified.
</li>
</ol>
</li>

<p><li>444237:  Add column labels to summary window

<p>Now summary window has been changed from Scroll view to List view. This list view contains the following columns: number, Ssource/Destination, Service Type.
</p>
</li>

<p><li>566972: Trace Window LEFT pane unusable
<p>To improve the usability of the left (summary) pane, the following enhancements were made:</p>
<ol>
<li> Moved all text to the far left in order to maximize space. </li>
<li> Moved the long timestamp to the right 'detailed' pane. </li>
<li> Spaces were removed between source and destination fields. </li> 
<li>  A thin column header was added to identify the columns in the left pane. </li>
</ol>
</li>

<p><li>444243: Autoscroll the summary view
<p>Now if the last packet in the session is selected and a new packet is sent or received, VTS3 can continue to keep the scroll value pegged to the bottom of the list, scrolling the current contents up, and make the new incoming packet the selected packet.
Note: when the selected packet isn't the last packet, VTS3 will not make a change to select the last packet when a new packet is sent or received. 
</p></li>
</ul>


<h2><a name="whatsnew">3.3.0</a></h2>
<ul>
<p><li>567046: Now the Detail pane is a treelist pane, with most of the tree nodes collapsed by 
default to reduce the amount of information shown.  The tree nodes containing the information
that is the most pertinent to the service are expanded by default.</li></p>

<p><li>485733: Added server side ReadProperty and WriteProperty support to internal Device Objects.  
This required changes to the .vdb database to store this information. </li></p>

<p><li>626601: Any attempt to open a read-only .vdb file is now greeted with a message instead of a crash.</li></p>

<p><li>Fixed all of the child popups decending from the Send dialog to retain their relationship to the parent.  Each 
occurrence was altered to report to the proper parent such that all of the popups are now modal
to the modeless Send dialog.  Multiple Send dialogs can now be used simultaneously.</li></p>

<p><li>Attempts to open a corrupted or inconsistent database now results in a report of the problem./li></p>

<p><li><b>Replaced the BACMACNT driver with WinPcap library calls.</b>  No change was made to the database format, just the
format of the adapter/interface configuration strings has changed.  BACMACNT is no longer required and is no longer distributed with VTS 3.x</li></p>

 
<p>&nbsp;</p>
<p><a href="#Links">[&nbsp;Next&nbsp;]</a>&nbsp;&nbsp;<a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="Links">VTS Web Links</a></h2>
<p>The home page of VTS is <a href="http://vts.sourceforge.net">http://vts.sourceforge.net</a></p>
<p>The home page of the BACnet Testing Laboratories (BTL) is <a href="http://www.bacnetassociation.org/bacnet_testing.htm">http://www.bacnetassociation.org/bacnet_testing.htm</a></p>
<p>&nbsp;</p>
<p><a href="#start">[&nbsp;Home&nbsp;]</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</body>

</html>